To better assist you, could you specify if you need any additional features or modifications in the TypeScript code, or should it strictly follow the C++ logic?